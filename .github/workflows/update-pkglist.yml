name: Auto-Update Package Lists

# Workflow manual ou agendado para atualizar listas de pacotes
on:
  workflow_dispatch:  # Permite execuÃ§Ã£o manual
  schedule:
    # Executa toda segunda-feira Ã s 9h UTC
    - cron: '0 9 * * 1'

jobs:
  update:
    name: Atualizar Listas de Pacotes
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      # Ordena e limpa as listas
      - name: Sort and clean package lists
        run: |
          echo "ðŸ”§ Ordenando e limpando listas de pacotes..."
          
          # Remove duplicatas e ordena pkglist.txt
          sort -u pkglist.txt -o pkglist.txt
          
          # Remove linhas vazias
          sed -i '/^$/d' pkglist.txt
          
          echo "âœ… Limpeza concluÃ­da"

      # Cria Pull Request se houver mudanÃ§as
      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          commit-message: 'chore: auto-update package lists'
          title: 'ðŸ¤– AtualizaÃ§Ã£o AutomÃ¡tica das Listas de Pacotes'
          body: |
            ## ðŸ“¦ AtualizaÃ§Ã£o AutomÃ¡tica
            
            Este PR foi criado automaticamente para atualizar as listas de pacotes.
            
            ### MudanÃ§as:
            - âœ… Pacotes ordenados alfabeticamente
            - âœ… Duplicatas removidas
            - âœ… Linhas vazias removidas
            
            Por favor, revise antes de fazer merge.
          branch: auto-update-pkglist
          delete-branch: true
          labels: automated, maintenance
